<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Edit Item</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Inter', sans-serif;
    }

    .form-container {
      width: 600px;
    }
  </style>
</head>

<body class="bg-dark text-white p-5 d-flex flex-column min-vh-100 justify-content-center align-items-center">
  <div class="card bg-secondary text-white rounded-3 shadow p-4 form-container">
    <h1 class="card-title text-center text-info mb-4">
      Edit
      <% if (editing === 'game') { %>
        Game
      <% } else if (editing === 'publisher') { %>
        Publisher
      <% } else if (editing === 'genre') { %>
        Genre
      <% } %>
    </h1>

    <% if (editing === 'game' && locals.game) { %>
      <form action="/game/update/<%= game.id %>" method="POST">
            <div class="mb-3">
              <label for="title" class="form-label">Title</label>
              <input type="text" class="form-control" id="title" name="title" value="<%= game.title %>" required>
            </div>
            <div class="mb-3">
              <label for="release_date" class="form-label">Release Date</label>
              <input type="date" class="form-control" id="release_date" name="release_date" value="<%= game.release_date.toISOString().substring(0, 10) %>" required>
            </div>
            <div class="mb-3">
              <label for="rating" class="form-label">Rating</label>
              <input type="number" class="form-control" id="rating" name="rating" min="1" max="5" value="<%= game.rating %>" required>
            </div>
            <div class="mb-3">
              <label for="description" class="form-label">Description</label>
              <textarea class="form-control" id="description" name="description" rows="5" required><%= game.description %></textarea>
            </div>
            <div class="mb-3">
              <label for="genres" class="form-label">Genres</label>
              <select class="form-select" id="genres" name="genres" multiple required>
                <% genres.forEach(genre => { %>
                  <option value="<%= genre.id %>"
                    <% if (game.genres && game.genres.find(g => g.id === genre.id)) { %>
                      selected
                    <% } %>
                  >
                    <%= genre.name %>
                  </option>
                <% }); %>
              </select>
            </div>
            <div class="mb-3">
              <label for="publishers" class="form-label">Publishers</label>
              <select class="form-select" id="publishers" name="publishers" multiple required>
                <% publishers.forEach(publisher => { %>
                  <option value="<%= publisher.id %>"
                    <% if (game.publishers && game.publishers.find(p => p.id === publisher.id)) { %>
                      selected
                    <% } %>
                  >
                    <%= publisher.name %>
                  </option>
                <% }); %>
              </select>
            </div>
            <button type="submit" class="btn btn-primary w-100">Update Game</button>
          </form>

    <% } else if (editing === 'publisher' && locals.publisher) { %>
      <form action="/publisher/update/<%= publisher.id %>" method="POST">
        <div class="mb-3">
          <label for="name" class="form-label">Name</label>
          <input type="text" class="form-control" id="name" name="name" value="<%= publisher.name %>" required>
        </div>
        <div class="mb-3">
          <label for="description" class="form-label">Description</label>
          <textarea class="form-control" id="description" name="description" rows="3" required><%= publisher.description %></textarea>
        </div>
        <button type="submit" class="btn btn-primary w-100">Update Publisher</button>
      </form>
      <form action="/publisher/delete/<%= publisher.id %>" method="POST" class="mt-3">
        <button type="submit" class="btn btn-danger w-100" onclick="return confirm('Are you sure you want to delete this publisher?');">Delete Publisher</button>
      </form>

    <% } else if (editing === 'genre' && locals.genre) { %>
      <form action="/genre/update/<%= genre.id %>" method="POST">
        <div class="mb-3">
          <label for="name" class="form-label">Name</label>
          <input type="text" class="form-control" id="name" name="name" value="<%= genre.name %>" required>
        </div>
        <div class="mb-3">
          <label for="description" class="form-label">Description</label>
          <textarea class="form-control" id="description" name="description" rows="3" required><%= genre.description %></textarea>
        </div>
        <button type="submit" class="btn btn-primary w-100">Update Genre</button>
      </form>
      <form action="/genre/delete/<%= genre.id %>" method="POST" class="mt-3">
        <button type="submit" class="btn btn-danger w-100" onclick="return confirm('Are you sure you want to delete this genre?');">Delete Genre</button>
      </form>
    
    <% } else { %>
        <p class="text-center lead">No item found for editing.</p>
    <% } %>

    <div class="text-center mt-4">
      <a href="/" class="btn btn-outline-light rounded-pill shadow-sm">Back to Home</a>
    </div>
  </div>
  <!-- Bootstrap Bundle with Popper -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>
